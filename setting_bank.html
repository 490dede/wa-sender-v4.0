<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setting Bank - Admin-Zero Only</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; background: #fdfdfd; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        input, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn-save { width: 100%; padding: 15px; background: #f39c12; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .header-box { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #f39c12; padding-bottom: 10px; }
    </style>
</head>
<body>

    <div class="header-box">
        <h2>SETTING BANK & REVENUE</h2>
        <p>Admin-Zero Exclusive Access</p>
    </div>

    <div class="card">
        <form id="bankForm">
            <div class="form-group">
                <label>Barcode QRIS eWallet (Text/URL Data):</label>
                <textarea id="qris" rows="3" placeholder="Input QRIS raw data or link..."></textarea>
            </div>

            <div class="form-group">
                <label>PayPal Account (Email):</label>
                <input type="email" id="paypal" placeholder="example@paypal.com">
            </div>

            <div class="form-group">
                <label>Rekening Bank MasterVisa:</label>
                <textarea id="mastervisa" rows="3" placeholder="Bank Name - Account Number - Name..."></textarea>
            </div>

            <button type="submit" class="btn-save">UPDATE & DISTRIBUTE TO ADMIN</button>
        </form>
        <button onclick="location.href='dashboard_admin_zero.html'" style="margin-top:15px; width:100%; background:none; border:none; color:gray; cursor:pointer;">
            Back to Dashboard / Kembali
        </button>
    </div>

    <script>
        const _supabase = supabase.createClient('https://fdvjaulucahzmmmdwkau.supabase.co', 'sb_publishable_yN4AQrZGQEH8tzhkCsLf2g_KGoakIFa');

        // Load data lama
        async function loadBankSettings() {
            const { data } = await _supabase.from('bank_settings').select('*').single();
            if (data) {
                document.getElementById('qris').value = data.qris_data;
                document.getElementById('paypal').value = data.paypal_email;
                document.getElementById('mastervisa').value = data.mastervisa_account;
            }
        }

        document.getElementById('bankForm').onsubmit = async (e) => {
            e.preventDefault();
            const { error } = await _supabase
                .from('bank_settings')
                .update({
                    qris_data: document.getElementById('qris').value,
                    paypal_email: document.getElementById('paypal').value,
                    mastervisa_account: document.getElementById('mastervisa').value,
                    updated_at: new Date()
                })
                .match({ id: (await _supabase.from('bank_settings').select('id').single()).data.id });

            if (!error) alert("Data Updated & Distributed! / Data Berhasil Diperbarui!");
            else alert("Error: " + error.message);
        };

        loadBankSettings();
    </script>
</body>
</html>
